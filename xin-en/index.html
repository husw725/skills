<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>è¶£å‘³è‹±è¯­é…å¯¹æ¸¸æˆ</title>
    <style>
        :root {
            --primary-color: #FFB6C1;
            --secondary-color: #87CEEB;
            --card-bg: #FFFFFF;
            --card-back: #FFD700;
            --text-color: #333333;
        }

        body {
            margin: 0;
            padding: 0;
            font-family: 'Comic Sans MS', 'Chalkboard SE', 'Arial Rounded MT Bold', sans-serif;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            touch-action: manipulation;
            user-select: none;
            -webkit-user-select: none;
        }

        h1 {
            color: #fff;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            margin: 20px 0 10px;
            font-size: 28px;
            text-align: center;
        }

        .subtitle {
            color: #fff;
            font-size: 16px;
            margin-bottom: 20px;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
        }

        .game-board {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            padding: 15px;
            max-width: 500px;
            width: 90%;
            box-sizing: border-box;
        }

        .card {
            aspect-ratio: 1 / 1;
            perspective: 1000px;
            cursor: pointer;
        }

        .card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            text-align: center;
            transition: transform 0.6s cubic-bezier(0.4, 0.2, 0.2, 1);
            transform-style: preserve-3d;
        }

        .card.flipped .card-inner, .card.matched .card-inner {
            transform: rotateY(180deg);
        }

        .card.matched .card-inner {
            animation: pulse 0.5s ease-in-out;
        }

        @keyframes pulse {
            0% { transform: rotateY(180deg) scale(1); }
            50% { transform: rotateY(180deg) scale(1.1); }
            100% { transform: rotateY(180deg) scale(1); }
        }

        .card-front, .card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }

        .card-front {
            background-color: var(--card-back);
            background-image: radial-gradient(circle, rgba(255,255,255,0.3) 2px, transparent 2px);
            background-size: 15px 15px;
            border: 3px solid #FFF;
        }

        .card-front::after {
            content: '?';
            font-size: 40px;
            color: white;
            font-weight: bold;
            text-shadow: 2px 2px 0px rgba(0,0,0,0.2);
        }

        .card-back {
            background-color: var(--card-bg);
            transform: rotateY(180deg);
            font-size: 45px; /* For Emojis */
            border: 3px solid #FFF;
            flex-direction: column;
        }

        .card-text {
            font-size: 24px;
            font-weight: bold;
            color: var(--text-color);
        }

        .stats {
            display: flex;
            justify-content: space-between;
            width: 90%;
            max-width: 400px;
            margin-top: 20px;
            color: white;
            font-size: 18px;
            font-weight: bold;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
        }

        /* Modal / Win Screen */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        @keyframes popIn {
            0% { transform: scale(0.5); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }

        .modal h2 {
            color: #FF6B6B;
            margin-top: 0;
            font-size: 32px;
        }

        .btn {
            background: #4ECDC4;
            color: white;
            border: none;
            padding: 12px 25px;
            font-size: 18px;
            border-radius: 30px;
            cursor: pointer;
            font-weight: bold;
            margin-top: 15px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: transform 0.1s;
        }

        .btn:active {
            transform: translateY(2px);
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        /* Confetti */
        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background-color: #f00;
            opacity: 0;
        }
    </style>
</head>
<body>

    <h1>å•è¯è¿è¿çœ‹ ğŸ</h1>
    <div class="subtitle">äººæ•™ç‰ˆä¸‰å¹´çº§ä¸Šå†Œ - æ–‡å…·ç¯‡</div>

    <div class="stats">
        <span>æ­¥æ•°: <span id="moves">0</span></span>
        <span>åŒ¹é…: <span id="matches">0</span>/<span id="totalPairs">6</span></span>
    </div>

    <div class="game-board" id="gameBoard">
        <!-- Cards will be generated here by JS -->
    </div>

    <div class="modal" id="winModal">
        <div class="modal-content">
            <h2>å¤ªæ£’å•¦ï¼ğŸŒŸ</h2>
            <p>ä½ å®Œæˆäº†æ‰€æœ‰å•è¯åŒ¹é…ï¼</p>
            <p>æ€»å…±ç”¨äº† <span id="finalMoves">0</span> æ­¥</p>
            <button class="btn" onclick="initGame()">ä¸‹ä¸€å…³</button>
        </div>
    </div>

    <script>
        // äººæ•™ç‰ˆä¸‰å¹´çº§ä¸Šå†Œ æ‰©å……è¯åº“
        const vocabularyPool = [
            // Unit 1: Stationery
            { word: 'ruler', icon: 'ğŸ“' },
            { word: 'pencil', icon: 'âœï¸' },
            { word: 'eraser', icon: 'ğŸ§½' },
            { word: 'crayon', icon: 'ğŸ–ï¸' },
            { word: 'bag', icon: 'ğŸ’' },
            { word: 'book', icon: 'ğŸ“–' },
            { word: 'pen', icon: 'ğŸ–Šï¸' },
            // Unit 2: Colors
            { word: 'red', icon: 'ğŸ”´' },
            { word: 'blue', icon: 'ğŸ”µ' },
            { word: 'green', icon: 'ğŸŸ¢' },
            { word: 'yellow', icon: 'ğŸŸ¡' },
            { word: 'black', icon: 'âš«' },
            { word: 'white', icon: 'âšª' },
            { word: 'orange', icon: 'ğŸŸ ' },
            // Unit 3: Body
            { word: 'face', icon: 'ğŸ˜Š' },
            { word: 'eye', icon: 'ğŸ‘ï¸' },
            { word: 'ear', icon: 'ğŸ‘‚' },
            { word: 'nose', icon: 'ğŸ‘ƒ' },
            { word: 'mouth', icon: 'ğŸ‘„' },
            { word: 'hand', icon: 'âœ‹' },
            { word: 'arm', icon: 'ğŸ’ª' },
            { word: 'leg', icon: 'ğŸ¦µ' },
            // Unit 4: Animals
            { word: 'cat', icon: 'ğŸ±' },
            { word: 'dog', icon: 'ğŸ¶' },
            { word: 'monkey', icon: 'ğŸ’' },
            { word: 'panda', icon: 'ğŸ¼' },
            { word: 'rabbit', icon: 'ğŸ°' },
            { word: 'duck', icon: 'ğŸ¦†' },
            { word: 'pig', icon: 'ğŸ·' },
            { word: 'bird', icon: 'ğŸ¦' },
            { word: 'bear', icon: 'ğŸ»' },
            { word: 'elephant', icon: 'ğŸ˜' },
            // Unit 5: Food/Fruits
            { word: 'apple', icon: 'ğŸ' },
            { word: 'pear', icon: 'ğŸ' },
            { word: 'banana', icon: 'ğŸŒ' },
            { word: 'cake', icon: 'ğŸ°' },
            { word: 'bread', icon: 'ğŸ' },
            { word: 'juice', icon: 'ğŸ¹' },
            { word: 'milk', icon: 'ğŸ¥›' },
            { word: 'egg', icon: 'ğŸ¥š' }
        ];

        let cards = [];
        let flippedCards = [];
        let matchedPairs = 0;
        let moves = 0;
        let isLocked = false;
        const PAIRS_PER_GAME = 6;

        const board = document.getElementById('gameBoard');
        const movesDisplay = document.getElementById('moves');
        const matchesDisplay = document.getElementById('matches');
        const totalPairsDisplay = document.getElementById('totalPairs');
        const winModal = document.getElementById('winModal');
        const finalMovesDisplay = document.getElementById('finalMoves');

        function speak(text) {
            if ('speechSynthesis' in window) {
                window.speechSynthesis.cancel();
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = 'en-US';
                utterance.rate = 0.8;
                utterance.pitch = 1.2;
                window.speechSynthesis.speak(utterance);
            }
        }

        function createCardElement(card) {
            const cardEl = document.createElement('div');
            cardEl.classList.add('card');
            
            const inner = document.createElement('div');
            inner.classList.add('card-inner');

            const front = document.createElement('div');
            front.classList.add('card-front');

            const back = document.createElement('div');
            back.classList.add('card-back');
            
            if (card.type === 'word') {
                const text = document.createElement('span');
                text.classList.add('card-text');
                text.innerText = card.word;
                back.appendChild(text);
            } else {
                back.innerText = card.icon;
            }

            inner.appendChild(front);
            inner.appendChild(back);
            cardEl.appendChild(inner);

            cardEl.addEventListener('click', () => flipCard(cardEl, card));

            return cardEl;
        }

        function initGame() {
            board.innerHTML = '';
            flippedCards = [];
            matchedPairs = 0;
            moves = 0;
            isLocked = false;
            winModal.style.display = 'none';
            totalPairsDisplay.innerText = PAIRS_PER_GAME;
            updateStats();

            // 1. ä»è¯åº“ä¸­éšæœºæŠ½å– 6 ä¸ªå•è¯
            const shuffledPool = [...vocabularyPool].sort(() => Math.random() - 0.5);
            const selectedVocabulary = shuffledPool.slice(0, PAIRS_PER_GAME);

            // 2. ç”Ÿæˆ 12 å¼ å¡ç‰‡ (6ä¸ªå•è¯ + 6ä¸ªå›¾æ ‡)
            cards = [];
            selectedVocabulary.forEach((item, index) => {
                cards.push({ id: index, word: item.word, type: 'word', icon: item.icon });
                cards.push({ id: index, word: item.word, type: 'icon', icon: item.icon });
            });

            // 3. å†æ¬¡æ‰“ä¹±å¡ç‰‡é¡ºåº
            cards.sort(() => Math.random() - 0.5);

            // 4. æ¸²æŸ“
            cards.forEach(card => {
                board.appendChild(createCardElement(card));
            });
        }

        function flipCard(cardEl, cardData) {
            if (isLocked) return;
            if (cardEl.classList.contains('flipped') || cardEl.classList.contains('matched')) return;

            cardEl.classList.add('flipped');
            flippedCards.push({ el: cardEl, data: cardData });

            speak(cardData.word);

            if (flippedCards.length === 2) {
                moves++;
                updateStats();
                checkMatch();
            }
        }

        function checkMatch() {
            isLocked = true;
            const [card1, card2] = flippedCards;

            const isMatch = card1.data.word === card2.data.word && card1.data.type !== card2.data.type;

            if (isMatch) {
                setTimeout(() => {
                    card1.el.classList.add('matched');
                    card2.el.classList.add('matched');
                    matchedPairs++;
                    updateStats();
                    flippedCards = [];
                    isLocked = false;
                    
                    speak("Correct! " + card1.data.word);

                    if (matchedPairs === PAIRS_PER_GAME) {
                        setTimeout(showWin, 500);
                    }
                }, 500);
            } else {
                setTimeout(() => {
                    card1.el.classList.remove('flipped');
                    card2.el.classList.remove('flipped');
                    flippedCards = [];
                    isLocked = false;
                }, 1000);
            }
        }

        function updateStats() {
            movesDisplay.innerText = moves;
            matchesDisplay.innerText = matchedPairs;
        }

        function showWin() {
            finalMovesDisplay.innerText = moves;
            winModal.style.display = 'flex';
            speak("Excellent! You win!");
            createConfetti();
        }

        // ç®€å•çš„æ’’èŠ±ç‰¹æ•ˆ
        function createConfetti() {
            const colors = ['#f00', '#0f0', '#00f', '#ff0', '#f0f', '#0ff'];
            for (let i = 0; i < 50; i++) {
                const confetti = document.createElement('div');
                confetti.classList.add('confetti');
                document.body.appendChild(confetti);

                const startX = Math.random() * window.innerWidth;
                const startY = -10;
                const color = colors[Math.floor(Math.random() * colors.length)];
                
                confetti.style.left = startX + 'px';
                confetti.style.top = startY + 'px';
                confetti.style.backgroundColor = color;
                
                const endX = startX + (Math.random() - 0.5) * 200;
                const endY = window.innerHeight + 10;
                const duration = Math.random() * 2 + 1;

                confetti.animate([
                    { transform: `translate3d(0,0,0) rotate(0deg)`, opacity: 1 },
                    { transform: `translate3d(${endX - startX}px, ${endY}px, 0) rotate(${Math.random()*720}deg)`, opacity: 0 }
                ], {
                    duration: duration * 1000,
                    easing: 'cubic-bezier(.37,0,.63,1)',
                    fill: 'forwards'
                });

                setTimeout(() => confetti.remove(), duration * 1000);
            }
        }

        // é¦–æ¬¡æç¤ºç‚¹å‡»å‘éŸ³éœ€ç”¨æˆ·äº¤äº’æˆæƒ (æµè§ˆå™¨å®‰å…¨ç­–ç•¥)
        document.body.addEventListener('click', function initAudio() {
            const utterance = new SpeechSynthesisUtterance('');
            window.speechSynthesis.speak(utterance);
            document.body.removeEventListener('click', initAudio);
        }, { once: true });

        // Start game
        initGame();
    </script>
</body>
</html>