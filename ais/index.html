<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>çŸ¥è¯†å°å‹‡å£« - äºŒå¹´çº§å¤§å†’é™©</title>
    <style>
        body { 
            font-family: 'Comic Sans MS', 'PingFang SC', 'Microsoft YaHei', sans-serif; 
            text-align: center; 
            background-color: #81d4fa; 
            margin: 0; 
            padding: 0; 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            height: 100vh; 
            overflow: hidden; 
            touch-action: manipulation; 
        }
        #app { 
            width: 100%; 
            max-width: 500px; 
            height: 100%; 
            max-height: 800px; 
            background: #ffffff; 
            display: flex; 
            flex-direction: column; 
            position: relative; 
            box-shadow: 0 0 20px rgba(0,0,0,0.2); 
        }
        .header { 
            background: #ffca28; 
            padding: 10px 20px; 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            font-size: 1.5rem; 
            font-weight: bold; 
            color: #d84315; 
            border-bottom: 4px solid #ffb300; 
        }
        .hearts { color: #f44336; letter-spacing: 2px;}
        .scene { 
            flex: 1; 
            display: flex; 
            flex-direction: column; 
            justify-content: flex-start; 
            align-items: center; 
            position: relative; 
            background: linear-gradient(#b3e5fc, #e1f5fe); 
            padding-top: 20px; 
        }
        .battle-area { 
            display: flex; 
            justify-content: space-around; 
            width: 100%; 
            align-items: flex-end; 
            margin-bottom: 20px; 
            height: 120px; 
        }
        .character { font-size: 5rem; user-select: none; }
        .hero { animation: bounce 1s infinite alternate; }
        .monster { animation: shake 0.5s infinite alternate; }
        .attack-anim { animation: attack 0.3s ease-in-out; }
        .monster-attack-anim { animation: monster-attack 0.3s ease-in-out; }
        .hurt-anim { animation: hurt 0.3s ease-in-out; filter: grayscale(100%); opacity: 0.7;}
        
        .question-box { 
            background: #fff9c4; 
            border: 4px solid #ff9800; 
            border-radius: 15px; 
            padding: 20px; 
            margin: 10px 20px; 
            font-size: 1.4rem; 
            font-weight: bold; 
            color: #333; 
            box-shadow: 0 4px 0 #ff9800; 
            min-height: 80px; 
            width: 80%;
            display: flex; 
            align-items: center; 
            justify-content: center; 
            flex-direction: column; 
        }
        #subject-tag {
            font-size: 1rem; 
            color: white; 
            background: #ff9800; 
            padding: 4px 12px; 
            border-radius: 15px; 
            margin-bottom: 10px;
        }
        .options { 
            display: flex; 
            flex-wrap: wrap; 
            justify-content: center; 
            gap: 15px; 
            padding: 10px 20px; 
            margin-bottom: 20px; 
            width: 90%;
        }
        .option-btn { 
            background: #4fc3f7; 
            color: white; 
            border: none; 
            border-bottom: 4px solid #0288d1; 
            border-radius: 12px; 
            padding: 15px; 
            font-size: 1.3rem; 
            font-weight: bold; 
            cursor: pointer; 
            flex: 1 1 40%; 
            min-width: 120px; 
            transition: all 0.1s; 
        }
        .option-btn:active, .option-btn.pressed { 
            transform: translateY(4px); 
            border-bottom: 0px; 
            margin-top: 4px; 
            margin-bottom: 0px;
        }
        .feedback { 
            font-size: 2rem; 
            font-weight: bold; 
            position: absolute; 
            top: 30%; 
            opacity: 0; 
            pointer-events: none; 
            transition: all 0.5s; 
            z-index: 5; 
        }
        .feedback.show { opacity: 1; transform: translateY(-50px); }
        .correct-text { color: #4caf50; text-shadow: 2px 2px 0 #fff; }
        .wrong-text { color: #f44336; text-shadow: 2px 2px 0 #fff; }
        
        .overlay { 
            position: absolute; 
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 100%; 
            background: rgba(255,255,255,0.95); 
            display: flex; 
            flex-direction: column; 
            justify-content: center; 
            align-items: center; 
            z-index: 10; 
        }
        .title { font-size: 3rem; color: #ff5722; text-shadow: 2px 2px 0px #ffe0b2; margin-bottom: 20px; font-weight: 900;}
        .subtitle { font-size: 1.2rem; color: #555; margin-bottom: 40px; padding: 0 20px; line-height: 1.6;}
        .big-btn { 
            background: #ff5252; 
            color: white; 
            border: none; 
            border-bottom: 6px solid #d32f2f; 
            border-radius: 20px; 
            padding: 20px 50px; 
            font-size: 2rem; 
            font-weight: bold; 
            cursor: pointer; 
            animation: pulse 1.5s infinite; 
        }
        .big-btn:active { transform: translateY(6px); border-bottom: 0; margin-top: 6px; }
        
        @keyframes bounce { from { transform: translateY(0); } to { transform: translateY(-15px); } }
        @keyframes shake { 0% { transform: translateX(0); } 25% { transform: translateX(-5px) rotate(-5deg); } 75% { transform: translateX(5px) rotate(5deg); } 100% { transform: translateX(0); } }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }
        @keyframes attack { 0% { transform: translateX(0); } 50% { transform: translateX(50px) scale(1.2); } 100% { transform: translateX(0); } }
        @keyframes monster-attack { 0% { transform: translateX(0); } 50% { transform: translateX(-50px) scale(1.2); } 100% { transform: translateX(0); } }
        @keyframes hurt { 0% { transform: translateX(0); } 25% { transform: translateX(-10px); } 50% { transform: translateX(10px); } 75% { transform: translateX(-10px); } 100% { transform: translateX(0); } }
        
        .hidden { display: none !important; }
    </style>
</head>
<body>
    <div id="app">
                <!-- Start Screen -->
                <div id="start-screen" class="overlay">
                    <div class="title">âš”ï¸ çŸ¥è¯†å°å‹‡å£«</div>
                    <div class="subtitle">äºŒå¹´çº§å¤§å†’é™©<br><br>é€‰æ‹©ä½ è¦æŒ‘æˆ˜çš„å…³å¡ï¼Œæ‰“è´¥å°æ€ªå…½ï¼Œæˆä¸ºçŸ¥è¯†å°è¾¾äººï¼</div>
                    <div style="display: flex; gap: 20px; flex-wrap: wrap; justify-content: center;">
                        <button class="big-btn" style="background: #4caf50; border-bottom-color: #388e3c;" onclick="startGame('æ•°å­¦')">ğŸ§® å¥‡å¦™æ•°å­¦</button>
                        <button class="big-btn" style="background: #ff9800; border-bottom-color: #f57c00;" onclick="startGame('è¯­æ–‡')">ğŸ“– è¶£å‘³è¯­æ–‡</button>
                    </div>
                </div>

        <!-- Game Over Screen -->
        <div id="game-over-screen" class="overlay hidden">
            <div class="title" id="end-title">æ¸¸æˆç»“æŸ</div>
            <div class="subtitle" id="end-score" style="font-size: 2.5rem; color: #ff9800; font-weight: bold;">å¾—åˆ†: 0</div>
            <button class="big-btn" onclick="returnToMenu()">è¿”å›ä¸»èœå•</button>
        </div>

        <!-- Main Game UI -->
        <div class="header">
            <div>â­ åˆ†æ•°: <span id="score">0</span></div>
            <div class="hearts" id="hp">â¤ï¸â¤ï¸â¤ï¸</div>
        </div>
        
        <div class="scene">
            <div class="battle-area">
                <div class="character hero" id="hero">ğŸ§‘â€ğŸ“</div>
                <div class="character monster" id="monster">ğŸ‘¾</div>
            </div>
            
            <div id="feedback" class="feedback">âœ… å¤ªæ£’å•¦ï¼</div>

            <div class="question-box">
                <span id="subject-tag">è¯­æ–‡</span>
                <div id="question-text">åŠ è½½ä¸­...</div>
            </div>
            
            <div class="options" id="options-container">
                <!-- Options will be injected here -->
            </div>
        </div>
    </div>

    <script>
        const questions = [
            // æ•°å­¦ (Math)
            { subject: 'æ•°å­¦', text: '25 + 14 = ?', options: ['39', '29', '49', '38'], answer: 0 },
            { subject: 'æ•°å­¦', text: '60 - 23 = ?', options: ['37', '47', '27', '43'], answer: 0 },
            { subject: 'æ•°å­¦', text: '3 Ã— 4 = ?', options: ['12', '7', '15', '14'], answer: 0 },
            { subject: 'æ•°å­¦', text: '5 Ã— 6 = ?', options: ['30', '25', '35', '11'], answer: 0 },
            { subject: 'æ•°å­¦', text: 'ä¹°ä¸€ä¸ªæœ¬å­2å…ƒï¼Œä¹°4ä¸ªéœ€è¦å¤šå°‘å…ƒï¼Ÿ', options: ['8å…ƒ', '6å…ƒ', '10å…ƒ', '4å…ƒ'], answer: 0 },
            { subject: 'æ•°å­¦', text: '8 Ã— 2 = ?', options: ['16', '10', '18', '14'], answer: 0 },
            { subject: 'æ•°å­¦', text: 'å°æ˜æœ‰15ä¸ªè‹¹æœï¼Œåƒæ‰6ä¸ªï¼Œè¿˜å‰©å‡ ä¸ªï¼Ÿ', options: ['9ä¸ª', '8ä¸ª', '10ä¸ª', '11ä¸ª'], answer: 0 },
            { subject: 'æ•°å­¦', text: '54 + 28 = ?', options: ['82', '72', '84', '74'], answer: 0 },
            { subject: 'æ•°å­¦', text: '1ç±³ = ( )å˜ç±³', options: ['100', '10', '50', '1000'], answer: 0 },
            { subject: 'æ•°å­¦', text: 'è§’æœ‰( )ä¸ªé¡¶ç‚¹', options: ['1', '2', '3', '0'], answer: 0 },
            { subject: 'æ•°å­¦', text: '7 Ã— 3 = ?', options: ['21', '24', '10', '28'], answer: 0 },
            { subject: 'æ•°å­¦', text: 'ä¸€ä¸ªæ­£æ–¹å½¢æœ‰( )æ¡è¾¹ã€‚', options: ['4', '3', '5', '6'], answer: 0 },
            
            // è¯­æ–‡ (Chinese)
            { subject: 'è¯­æ–‡', text: 'ç™½æ—¥ä¾å±±( )ï¼Œé»„æ²³å…¥æµ·æµã€‚', options: ['å°½', 'è¿›', 'è¿‘', 'é‡‘'], answer: 0 },
            { subject: 'è¯­æ–‡', text: 'â€œé«˜å…´â€çš„åä¹‰è¯æ˜¯ï¼Ÿ', options: ['éš¾è¿‡', 'å¿«ä¹', 'å¼€å¿ƒ', 'ç”Ÿæ°”'], answer: 0 },
            { subject: 'è¯­æ–‡', text: 'â€œè‘¡è„â€çš„â€œè‘¡â€è¯»éŸ³æ˜¯ï¼Ÿ', options: ['pÃº', 'pÅ«', 'pÇ”', 'pÃ¹'], answer: 0 },
            { subject: 'è¯­æ–‡', text: 'ä¸‹é¢å“ªä¸ªè¯è¯­æ˜¯æå†™æ˜¥å¤©çš„ï¼Ÿ', options: ['æ˜¥æš–èŠ±å¼€', 'å†°å¤©é›ªåœ°', 'ç§‹é«˜æ°”çˆ½', 'éª„é˜³ä¼¼ç«'], answer: 0 },
            { subject: 'è¯­æ–‡', text: 'â€œç‹å‡è™å¨â€ä¸­â€œå‡â€çš„æ„æ€æ˜¯ï¼Ÿ', options: ['å€Ÿç”¨', 'å‡çš„', 'æ”¾å‡', 'ä¸æ˜¯çœŸçš„'], answer: 0 },
            { subject: 'è¯­æ–‡', text: 'ä¸¾å¤´æœ›æ˜æœˆï¼Œ( )ã€‚', options: ['ä½å¤´æ€æ•…ä¹¡', 'ç–‘æ˜¯åœ°ä¸Šéœœ', 'æ˜¥é£å¹åˆç”Ÿ', 'å¤„å¤„é—»å•¼é¸Ÿ'], answer: 0 },
            { subject: 'è¯­æ–‡', text: 'â€œä¸€( )æ°´ç‰›â€ï¼Œæ‹¬å·é‡Œåº”å¡«ï¼Ÿ', options: ['å¤´', 'åª', 'åŒ¹', 'æ¡'], answer: 0 },
            { subject: 'è¯­æ–‡', text: 'ä¸‹é¢å“ªä¸ªå­—æ˜¯åŠåŒ…å›´ç»“æ„ï¼Ÿ', options: ['è¿‡', 'æœ¨', 'å›½', 'æ—'], answer: 0 },
            { subject: 'è¯­æ–‡', text: 'â€œæ¼‚äº®â€çš„è¿‘ä¹‰è¯æ˜¯ï¼Ÿ', options: ['ç¾ä¸½', 'éš¾çœ‹', 'ä¸‘é™‹', 'å¥‡æ€ª'], answer: 0 },
            { subject: 'è¯­æ–‡', text: 'ã€Šå’é¹…ã€‹çš„ä½œè€…æ˜¯ï¼Ÿ', options: ['éª†å®¾ç‹', 'æç™½', 'æœç”«', 'ç™½å±…æ˜“'], answer: 0 },
            { subject: 'è¯­æ–‡', text: 'å¤œæ¥é£é›¨å£°ï¼ŒèŠ±è½çŸ¥( )ã€‚', options: ['å¤šå°‘', 'å†¬å¤', 'å¤§å°', 'æ˜¥ç§‹'], answer: 0 },
            { subject: 'è¯­æ–‡', text: 'â€œæ˜â€å­—æ˜¯ç”±å“ªä¸¤ä¸ªå­—ç»„æˆçš„ï¼Ÿ', options: ['æ—¥å’Œæœˆ', 'ç™½å’Œæ°´', 'ç›®å’Œæœˆ', 'å£å’Œå'], answer: 0 }
        ];

        let currentScore = 0;
        let currentHp = 3;
        let currentQuestion = null;
        let isAnimating = false;
        let currentMode = 'æ•°å­¦';

        const monsters = ['ğŸ‘¾', 'ğŸ‰', 'ğŸ‘¹', 'ğŸ‘»', 'ğŸ¦‡', 'ğŸ•·ï¸', 'ğŸ¦‚', 'ğŸ¦–', 'ğŸ', 'ğŸ¦…'];

        function startGame(mode) {
            currentMode = mode;
            currentScore = 0;
            currentHp = 3;
            document.getElementById('start-screen').classList.add('hidden');
            document.getElementById('game-over-screen').classList.add('hidden');
            updateUI();
            nextQuestion();
        }

        function returnToMenu() {
            document.getElementById('game-over-screen').classList.add('hidden');
            document.getElementById('start-screen').classList.remove('hidden');
        }

        function updateUI() {
            document.getElementById('score').innerText = currentScore;
            // Draw hearts (Red for remaining, empty/white heart for lost)
            let heartsHtml = '';
            for(let i=0; i<3; i++) {
                if(i < currentHp) heartsHtml += 'â¤ï¸';
                else heartsHtml += 'ğŸ¤';
            }
            document.getElementById('hp').innerText = heartsHtml;
        }

        function nextQuestion() {
            // Pick a random monster
            document.getElementById('monster').innerText = monsters[Math.floor(Math.random() * monsters.length)];
            
            // Filter questions by mode
            const filteredQuestions = questions.filter(q => q.subject === currentMode);
            // Pick a random question
            const qIndex = Math.floor(Math.random() * filteredQuestions.length);
            const q = filteredQuestions[qIndex];
            currentQuestion = q;
            
            const subjectTag = document.getElementById('subject-tag');
            subjectTag.innerText = q.subject;
            subjectTag.style.background = q.subject === 'è¯­æ–‡' ? '#ff9800' : '#4caf50';
            
            document.getElementById('question-text').innerText = q.text;
            
            // Shuffle options
            const optionsWithIndices = q.options.map((opt, index) => ({ text: opt, isCorrect: index === q.answer }));
            for (let i = optionsWithIndices.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [optionsWithIndices[i], optionsWithIndices[j]] = [optionsWithIndices[j], optionsWithIndices[i]];
            }
            
            const optionsContainer = document.getElementById('options-container');
            optionsContainer.innerHTML = '';
            
            optionsWithIndices.forEach(opt => {
                const btn = document.createElement('button');
                btn.className = 'option-btn';
                btn.innerText = opt.text;
                btn.onclick = () => checkAnswer(opt.isCorrect, btn);
                optionsContainer.appendChild(btn);
            });
        }

        function checkAnswer(isCorrect, btn) {
            if (isAnimating) return;
            isAnimating = true;
            btn.classList.add('pressed');
            
            const hero = document.getElementById('hero');
            const monster = document.getElementById('monster');
            const feedback = document.getElementById('feedback');
            
            if (isCorrect) {
                // Correct Answer
                currentScore += 10;
                updateUI();
                btn.style.background = '#4caf50';
                
                // Hero Attack Animation
                hero.classList.add('attack-anim');
                setTimeout(() => {
                    monster.classList.add('hurt-anim');
                    feedback.innerText = 'âœ… ç­”å¯¹å•¦ï¼';
                    feedback.className = 'feedback show correct-text';
                }, 150);
                
                setTimeout(() => {
                    hero.classList.remove('attack-anim');
                    monster.classList.remove('hurt-anim');
                    feedback.className = 'feedback';
                    isAnimating = false;
                    nextQuestion();
                }, 1200);
                
            } else {
                // Wrong Answer
                currentHp -= 1;
                updateUI();
                btn.style.background = '#f44336';
                
                // Show Correct Answer on buttons
                const buttons = document.querySelectorAll('.option-btn');
                buttons.forEach(b => {
                    if(b.innerText === currentQuestion.options[currentQuestion.answer]) {
                        b.style.background = '#4caf50';
                    }
                });
                
                // Monster Attack Animation
                monster.classList.add('monster-attack-anim');
                setTimeout(() => {
                    hero.classList.add('hurt-anim');
                    feedback.innerText = 'âŒ ç­”é”™å•¦ï¼';
                    feedback.className = 'feedback show wrong-text';
                }, 150);
                
                setTimeout(() => {
                    monster.classList.remove('monster-attack-anim');
                    hero.classList.remove('hurt-anim');
                    feedback.className = 'feedback';
                    
                    if (currentHp <= 0) {
                        gameOver();
                    } else {
                        isAnimating = false;
                        nextQuestion();
                    }
                }, 1500);
            }
        }

        function gameOver() {
            isAnimating = false;
            document.getElementById('end-score').innerText = 'å¾—åˆ†: ' + currentScore;
            const endTitle = document.getElementById('end-title');
            if(currentScore >= 100) {
                endTitle.innerText = 'ğŸ† çŸ¥è¯†å¤§å®—å¸ˆï¼';
            } else if (currentScore >= 50) {
                endTitle.innerText = 'ğŸŒŸ çŸ¥è¯†å°è¾¾äººï¼';
            } else {
                endTitle.innerText = 'ğŸ’ª ç»§ç»­åŠ æ²¹å“¦ï¼';
            }
            document.getElementById('game-over-screen').classList.remove('hidden');
        }
    </script>
</body>
</html>